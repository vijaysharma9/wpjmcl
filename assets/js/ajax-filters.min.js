jQuery(document).ready(function(a){var b=[];a(".companies").on("update_results",function(c,d,e){var f="",g=a(this),h=g.find(".company_filters"),i=g.find(".showing_companies"),j=g.find(".companies"),k=g.data("per_page"),l=g.data("orderby"),m=g.data("order"),n=g.data("featured"),o=a("div.companies").index(this);if(b[o]&&b[o].abort(),e?a(".load_more_companies",g).addClass("loading"):(a(j).addClass("loading"),a("li.company, li.no_companies_found",j).css("visibility","hidden")),1==g.data("show_filters")){var p=h.find(':input[name^="search_categories"]').map(function(){return a(this).val()}).get(),q="",r="",s=h.find(':input[name="search_keywords"]'),t=h.find(':input[name="search_location"]');s.val()!=s.attr("placeholder")&&(q=s.val()),t.val()!=t.attr("placeholder")&&(r=t.val());var f={action:"company_listings_get_companies",search_keywords:q,search_location:r,search_categories:p,per_page:k,orderby:l,order:m,page:d,featured:n,show_pagination:g.data("show_pagination"),form_data:h.serialize()}}else var f={action:"company_listings_get_companies",search_categories:g.data("categories").split(","),search_keywords:g.data("keywords"),search_location:g.data("location"),per_page:k,orderby:l,order:m,featured:n,page:d,show_pagination:g.data("show_pagination")};b[o]=a.ajax({type:"POST",url:company_listings_ajax_filters.ajax_url,data:f,success:function(b){if(b)try{b.indexOf("\x3c!--WPJM--\x3e")>=0&&(b=b.split("\x3c!--WPJM--\x3e")[1]),b.indexOf("\x3c!--WPJM_END--\x3e")>=0&&(b=b.split("\x3c!--WPJM_END--\x3e")[0]);var c=a.parseJSON(b);c.showing?a(i).show().html("").append("<span>"+c.showing+"</span>"+c.showing_links):a(i).hide(),c.html&&(e?a(j).append(c.html):a(j).html(c.html)),1==g.data("show_pagination")?(g.find(".job-manager-pagination").remove(),c.pagination&&g.append(c.pagination)):(c.found_companies&&c.max_num_pages!==d?a(".load_more_companies",g).show().data("page",d):a(".load_more_companies",g).hide(),a(".load_more_companies",g).removeClass("loading"),a("li.company",j).css("visibility","visible")),a(j).removeClass("loading"),g.triggerHandler("updated_results",c)}catch(f){}}})}),a("#search_keywords, #search_location, #search_categories").change(function(){a(this).closest("div.companies").triggerHandler("update_results",[1,!1])}).change(),a(".company_filters").on("click",".reset",function(){var b=a(this).closest("div.companies"),c=a(this).closest("form");return c.find(':input[name="search_keywords"]').not(':input[type="hidden"]').val(""),c.find(':input[name="search_location"]').not(':input[type="hidden"]').val(""),c.find(':input[name^="search_categories"]').not(':input[type="hidden"]').val(0).trigger("chosen:updated"),b.triggerHandler("reset"),b.triggerHandler("update_results",[1,!1]),!1}),a(".load_more_companies").click(function(){var b=a(this).closest("div.companies"),c=a(this).data("page");return c=c?parseInt(c):1,a(this).data("page",c+1),b.triggerHandler("update_results",[c+1,!0]),!1}),a("div.companies").on("click",".job-manager-pagination a",function(){var b=a(this).closest("div.companies"),c=a(this).data("page");return b.triggerHandler("update_results",[c,!1]),!1}),a.isFunction(a.fn.chosen)&&a('select[name^="search_categories"]').chosen()});