jQuery(document).ready(function(a){function b(){a("fieldset.import-from-linkedin").remove(),IN.API.Profile("me").fields(["firstName","lastName","formattedName","headline","summary","specialties","associations","interests","pictureUrl","publicProfileUrl","emailAddress","location:(name)","dateOfBirth","threeCurrentPositions:(title,company,summary,startDate,endDate,isCurrent)","threePastPositions:(title,company,summary,startDate,endDate,isCurrent)","positions:(title,company,summary,startDate,endDate,isCurrent)","perks:(schoolName,degree,fieldOfStudy,startDate,endDate,activities,notes)","skills:(skill)","phoneNumbers","primaryTwitterAccount","memberUrlResources"]).result(function(b){var c=b.values[0];if($form=a("#submit-company-form"),$form.find('input[name="company_name"]').val(c.formattedName),$form.find('input[name="company_email"]').val(c.emailAddress),$form.find('input[name="company_title"]').val(c.headline),$form.find('input[name="company_location"]').val(c.location.name),c.summary&&($form.find('textarea[name="company_content"]').val(c.summary),"object"===a.type(tinymce)&&tinymce.get("company_content").setContent(c.summary)),a(c.skills.values).each(function(a,b){$form.find('input[name="company_skills"]').val()?$form.find('input[name="company_skills"]').val($form.find('input[name="company_skills"]').val()+", "+b.skill.name):$form.find('input[name="company_skills"]').val(b.skill.name)}),a(c.memberUrlResources.values).each(function(b,c){c.name&&c.url&&(a(".fieldset-links").find(".company-listings-add-row").click(),a(".fieldset-links").find('input[name^="link_name"]').last().val(c.name),a(".fieldset-links").find('input[name^="link_url"]').last().val(c.url))}),a(c.memberUrlResources.values).each(function(b,c){c.name&&c.url&&(a(".fieldset-info").find(".company-listings-add-row").click(),a(".fieldset-info").find('input[name^="info_name"]').last().val(c.name),a(".fieldset-info").find('input[name^="info_info"]').last().val(c.url))}),a(c.perks.values).each(function(b,c){var d=[],e=[];c.fieldOfStudy&&d.push(c.fieldOfStudy),c.degree&&d.push(c.degree),c.startDate&&e.push(c.startDate.year),c.endDate&&e.push(c.endDate.year),a(".fieldset-company_perk").find(".company-listings-add-row").click(),a(".fieldset-company_perk").find('input[name^="company_perk_location"]').last().val(c.schoolName),a(".fieldset-company_perk").find('input[name^="company_perk_qualification"]').last().val(d.join(", ")),a(".fieldset-company_perk").find('input[name^="company_perk_date"]').last().val(e.join("-")),a(".fieldset-company_perk").find('textarea[name^="company_perk_notes"]').last().val(c.notes)}),a(c.positions.values).each(function(b,c){var d=[];c.startDate&&d.push(c.startDate.year),c.endDate&&d.push(c.endDate.year),a(".fieldset-company_press").find(".company-listings-add-row").click(),a(".fieldset-company_press").find('input[name^="company_press_employer"]').last().val(c.company.name),a(".fieldset-company_press").find('input[name^="company_press_job_title"]').last().val(c.title),a(".fieldset-company_press").find('input[name^="company_press_date"]').last().val(d.join("-")),a(".fieldset-company_press").find('textarea[name^="company_press_notes"]').last().val(c.summary)}),c.pictureUrl){var d=a(".fieldset-company_photo .field");if(d)var e=d.find(':input[type="file"]').attr("name");a(".fieldset-company_logo .field").prepend('<div class="job-manager-uploaded-files"><div class="job-manager-uploaded-file"><span class="job-manager-uploaded-file-preview"><img src="'+c.pictureUrl+'" /> <a class="job-manager-remove-uploaded-file" href="#">['+company_listings_company_submission.i18n_remove+']</a></span><input type="hidden" class="input-text" name="current_'+e+'" value="'+c.pictureUrl+'" /></div></div>')}$form.trigger("linkedin_import",c)})}a(".company-listings-add-row").click(function(){var b=a(this).closest(".field"),c=0;b.find("input.repeated-row-index").each(function(){parseInt(a(this).val())>c&&(c=parseInt(a(this).val()))});var d=a(this).data("row").replace(/%%repeated-row-index%%/g,c+1);return a(this).before(d),!1}),a("#submit-company-form").on("click",".company-listings-remove-row",function(){return confirm(company_listings_company_submission.i18n_confirm_remove)&&a(this).closest("div.company-listings-data-row").remove(),!1}),a("#submit-company-form").on("click",".job-manager-remove-uploaded-file",function(){return a(this).closest(".job-manager-uploaded-file").remove(),!1}),a(".fieldset-company_press .field, .fieldset-company_perk .field, .fieldset-links .field, .fieldset-info .field").sortable({items:".company-listings-data-row",cursor:"move",axis:"y",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65});var c=!1;a("form#company_preview").size()&&(c=!0),a("form#submit-company-form").on("change","input",function(){c=!0}),a("form#submit-company-form, form#company_preview").submit(function(){return c=!1,!0}),a(window).bind("beforeunload",function(a){if(c)return company_listings_company_submission.i18n_navigate}),a("input.import-from-linkedin").click(function(){return IN.User.isAuthorized()?b():(IN.Event.on(IN,"auth",b),IN.UI.Authorize().place()),!1})});