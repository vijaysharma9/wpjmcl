jQuery(document).ready(function(e){function n(){e("fieldset.import-from-linkedin").remove(),IN.API.Profile("me").fields(["firstName","lastName","formattedName","headline","summary","specialties","associations","interests","pictureUrl","publicProfileUrl","emailAddress","location:(name)","dateOfBirth","threeCurrentPositions:(title,company,summary,startDate,endDate,isCurrent)","threePastPositions:(title,company,summary,startDate,endDate,isCurrent)","positions:(title,company,summary,startDate,endDate,isCurrent)","educations:(schoolName,degree,fieldOfStudy,startDate,endDate,activities,notes)","skills:(skill)","phoneNumbers","primaryTwitterAccount","memberUrlResources"]).result(function(n){var i=n.values[0];if($form=e("#submit-company-form"),$form.find('input[name="company_name"]').val(i.formattedName),$form.find('input[name="company_email"]').val(i.emailAddress),$form.find('input[name="company_title"]').val(i.headline),$form.find('input[name="company_location"]').val(i.location.name),i.summary&&($form.find('textarea[name="company_content"]').val(i.summary),"object"===e.type(tinymce)&&tinymce.get("company_content").setContent(i.summary)),e(i.skills.values).each(function(e,n){$form.find('input[name="company_skills"]').val()?$form.find('input[name="company_skills"]').val($form.find('input[name="company_skills"]').val()+", "+n.skill.name):$form.find('input[name="company_skills"]').val(n.skill.name)}),e(i.memberUrlResources.values).each(function(n,i){i.name&&i.url&&(e(".fieldset-links").find(".company-listings-add-row").click(),e(".fieldset-links").find('input[name^="link_name"]').last().val(i.name),e(".fieldset-links").find('input[name^="link_url"]').last().val(i.url))}),e(i.memberUrlResources.values).each(function(n,i){i.name&&i.url&&(e(".fieldset-info").find(".company-listings-add-row").click(),e(".fieldset-info").find('input[name^="info_name"]').last().val(i.name),e(".fieldset-info").find('input[name^="info_info"]').last().val(i.url))}),e(i.educations.values).each(function(n,i){var a=[],t=[];i.fieldOfStudy&&a.push(i.fieldOfStudy),i.degree&&a.push(i.degree),i.startDate&&t.push(i.startDate.year),i.endDate&&t.push(i.endDate.year),e(".fieldset-company_education").find(".company-listings-add-row").click(),e(".fieldset-company_education").find('input[name^="company_education_location"]').last().val(i.schoolName),e(".fieldset-company_education").find('input[name^="company_education_qualification"]').last().val(a.join(", ")),e(".fieldset-company_education").find('input[name^="company_education_date"]').last().val(t.join("-")),e(".fieldset-company_education").find('textarea[name^="company_education_notes"]').last().val(i.notes)}),e(i.positions.values).each(function(n,i){var a=[];i.startDate&&a.push(i.startDate.year),i.endDate&&a.push(i.endDate.year),e(".fieldset-company_experience").find(".company-listings-add-row").click(),e(".fieldset-company_experience").find('input[name^="company_experience_employer"]').last().val(i.company.name),e(".fieldset-company_experience").find('input[name^="company_experience_job_title"]').last().val(i.title),e(".fieldset-company_experience").find('input[name^="company_experience_date"]').last().val(a.join("-")),e(".fieldset-company_experience").find('textarea[name^="company_experience_notes"]').last().val(i.summary)}),i.pictureUrl){var a=e(".fieldset-company_photo .field");if(a)var t=a.find(':input[type="file"]').attr("name");e(".fieldset-company_photo .field").prepend('<div class="job-manager-uploaded-files"><div class="job-manager-uploaded-file"><span class="job-manager-uploaded-file-preview"><img src="'+i.pictureUrl+'" /> <a class="job-manager-remove-uploaded-file" href="#">['+company_listings_company_submission.i18n_remove+']</a></span><input type="hidden" class="input-text" name="current_'+t+'" value="'+i.pictureUrl+'" /></div></div>')}$form.trigger("linkedin_import",i)})}e(".company-listings-add-row").click(function(){var n=e(this).closest(".field"),i=0;n.find("input.repeated-row-index").each(function(){parseInt(e(this).val())>i&&(i=parseInt(e(this).val()))});var a=e(this).data("row").replace(/%%repeated-row-index%%/g,i+1);return e(this).before(a),!1}),e("#submit-company-form").on("click",".company-listings-remove-row",function(){return confirm(company_listings_company_submission.i18n_confirm_remove)&&e(this).closest("div.company-listings-data-row").remove(),!1}),e("#submit-company-form").on("click",".job-manager-remove-uploaded-file",function(){return e(this).closest(".job-manager-uploaded-file").remove(),!1}),e(".fieldset-company_experience .field, .fieldset-company_education .field, .fieldset-links .field, .fieldset-info .field").sortable({items:".company-listings-data-row",cursor:"move",axis:"y",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65});var i=!1;e("form#company_preview").size()&&(i=!0),e("form#submit-company-form").on("change","input",function(){i=!0}),e("form#submit-company-form, form#company_preview").submit(function(){return i=!1,!0}),e(window).bind("beforeunload",function(e){return i?company_listings_company_submission.i18n_navigate:void 0}),e("input.import-from-linkedin").click(function(){return IN.User.isAuthorized()?n():(IN.Event.on(IN,"auth",n),IN.UI.Authorize().place()),!1})});